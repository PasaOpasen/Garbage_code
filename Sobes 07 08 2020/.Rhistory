library(tidyverse)
library(readxl)
remains = read_xls('remains.xlsx')
remains = read_xlsx('remains.xlsx')
View(remains)
View(remains)
View(remains)
View(remains)
colnames(remains) = c('id', 'size', 'free_count', 'self_cost', 'sell_cost')
View(remains)
View(remains)
sells = read_xlsx('sells.xlsx')
colnames(sells) = c('id_old', 'size', 'month', 'sell_count')
View(sells)
View(sells)
new.id = sells$id_old
for(id in new.id){
if(grepl('/', id)){
print(id)
}
}
for(id in new.id){
if(grepl('/', id)){
pair = strsplit(id, '/')
print(pair)
}
}
View(remains)
View(remains)
for(id in new.id){
if(grepl('/', id)){
pair = strsplit(id, '/')
if(nchar(pair[1])==12){
id = paste0(pair[1],pair[2])
print(id)
}
}
}
for(id in new.id){
if(grepl('/', id)){
pair = strsplit(id, '/')[[1]]
if(nchar(pair[1])==12){
id = paste0(pair[1],pair[2])
print(id)
}
}
}
'abcd'[1:2]
as.character('abcd')[1:2]
substr('abcd',1,2)
for(id in new.id){
if(grepl('/', id)){
pair = strsplit(id, '/')[[1]]
if(nchar(pair[1])==12){
id = paste0(pair[1],pair[2])
}else if(nchar(pair[1])==14){
left12 = substr(pair[1],1,12)
last2 = substr(pair[1],13,14)
right = substr(pair[2],1,2)
id = paste0(left12, right, last2)
print(id)
}else{
id = pair[1]
}
}
}
sells$id_old = new.id
colnames(sells)[1] = 'id'
remains$id = str_remove(remains$id, ' ')
View(remains)
View(remains)
sell_unique = unique(sells$id)
View(sells)
View(sells)
source('C:/Users/qtckp/OneDrive/Рабочий стол/Garbage_code/Sobes 07 08 2020/base_script.R')
remains_unique = unique(remains$id)
diffs = setdiff(sell_unique, remains_unique)
View(remains)
View(remains)
View(remains)
View(remains)
remains = rbind(remains, tibble(id = diffs, size = sells$size[sells$id == diffs], free_count = 0, self_cost = 200, sell_cost = 1000 ))
remains = rbind(remains,
tibble(id = diffs,
size = sapply(diffs, function(d) sells[sells$id == d,2][1] ),#sells$size[sells$id == diffs],
free_count = 0, self_cost = 200, sell_cost = 1000 ))
View(remains)
View(remains)
sizes = sapply(diffs, function(d) sells[sells$id == d,2] )
View(sizes)
View(sizes)
sizes = sapply(diffs, function(d) sells[sells$id == d,2][1] )
View(sizes)
View(sizes)
sizes = sapply(diffs, function(d) sells[sells$id == d,2][[1]] )
View(sizes)
View(sizes)
sizes = sapply(diffs, function(d) sells[sells$id == d,2][[1]][[1]] )
source('C:/Users/qtckp/OneDrive/Рабочий стол/Garbage_code/Sobes 07 08 2020/base_script.R')
View(remains)
View(remains)
